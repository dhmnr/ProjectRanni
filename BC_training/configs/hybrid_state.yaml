# Hybrid State Model Configuration
# CNN + Game State (HP, stamina, positions, etc.) for behavior cloning

dataset:
  path: "./dataset/margit_100_256x144.zarr"
  train_ratio: 0.8
  val_ratio: 0.2
  split_seed: 42
  normalize_frames: true
  use_state: true  # Enable state loading
  validate_episodes: true

# State preprocessing (applied to all models using state)
# All false: 19 raw features (pass-through)
# normalize_resources=true: 15 features (HP/SP/FP normalized to [0,1], max columns dropped)
state_preprocessing:
  normalize_resources: false  # HP/SP/FP divided by max values -> [0,1], drops max columns
  compute_distances: false   # TODO: Add distance to boss
  compute_relative_angles: false  # TODO: Add angle to boss

model:
  name: hybrid_state
  # CNN encoder
  conv_features: [32, 64, 128, 256]
  # State encoder (MLP)
  state_encoder_features: [64, 64]
  state_output_features: 64
  # Fusion dense layers
  dense_features: [512, 256]
  dropout_rate: 0.3  # Higher dropout for regularization
  use_batch_norm: true

training:
  batch_size: 32
  num_epochs: 100
  learning_rate: 0.001
  weight_decay: 0.001  # Higher weight decay
  lr_schedule:
    type: cosine
    warmup_epochs: 5
    min_lr: 0.00001
  use_class_weights: true
  label_smoothing: 0.0
  grad_clip_norm: 1.0
  checkpoint_dir: "./checkpoints/hybrid_state"
  save_every_n_epochs: 10
  keep_last_n_checkpoints: 3

evaluation:
  eval_every_n_epochs: 1
  metrics_threshold: 0.5

logging:
  use_wandb: true
  wandb_project: "ProjectRanni-BC"
  wandb_entity: "dhmnr-projects"
  wandb_run_name: "hybrid_state_raw_baseline"
  log_every_n_steps: 50
  log_gradients: false

system:
  seed: 42
  num_workers: 4
  pin_memory: false

